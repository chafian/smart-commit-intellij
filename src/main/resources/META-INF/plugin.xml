<idea-plugin>
    <id>com.smartcommit</id>
    <name>Smart Commit</name>
    <vendor email="support@websouf.com" url="https://github.com/chafian/smart-commit-intellij">
        Smart Commit
    </vendor>

    <description><![CDATA[
        <h2>Smart Commit — AI-Powered Git Commit Message Generator</h2>
        <p>Automatically generate professional, meaningful Git commit messages by analyzing your staged changes.</p>

        <h3>Features</h3>
        <ul>
            <li><b>AI-Powered:</b> Uses OpenAI (GPT-4o) or Ollama (local LLM) to generate context-aware messages</li>
            <li><b>Template-Based:</b> Deterministic offline fallback using file paths, change types, and classification</li>
            <li><b>Convention Support:</b> Gitmoji, Conventional Commits, or free-form formatting</li>
            <li><b>Multi-Language:</b> Generate commit messages in 12 languages (English, Chinese, Japanese, and more)</li>
            <li><b>Commit Style:</b> Choose between one-line (title only) or detailed (title + body) messages</li>
            <li><b>Message History:</b> Browse and reuse previously generated commit messages</li>
            <li><b>Custom Prompts:</b> Define your own AI system prompt or template for team-specific commit styles</li>
            <li><b>Smart Scope Detection:</b> Automatically detects module names from Gradle, Maven, npm, and other build systems</li>
            <li><b>Privacy-Friendly:</b> Use Ollama for fully local generation — no data leaves your machine</li>
        </ul>

        <h3>Quick Start</h3>
        <ol>
            <li>Open the <b>Commit</b> tool window (<code>Alt+0</code>)</li>
            <li>Stage your changes (check files in the changelist)</li>
            <li>Press <code>Alt+G</code> or click the <b>lightning bolt</b> button in the commit message toolbar</li>
            <li>The generated message will be inserted into the commit message field</li>
        </ol>

        <h3>Settings</h3>
        <p>Configure the plugin via one of these methods:</p>
        <ul>
            <li><b>Menu:</b> <code>Tools &rarr; Smart Commit Settings...</code></li>
            <li><b>Settings dialog:</b> <code>Ctrl+Alt+S</code> &rarr; <code>Tools</code> &rarr; <code>Smart Commit</code></li>
            <li><b>Search:</b> Double-tap <code>Shift</code>, type "Smart Commit Settings"</li>
        </ul>
        <p>In Settings you can configure:</p>
        <ul>
            <li><b>Generator Mode</b> — AI-Powered or Template-Based</li>
            <li><b>AI Provider</b> — OpenAI (cloud) or Ollama (local)</li>
            <li><b>API Key</b> — Your OpenAI API key (stored securely in the system credential store)</li>
            <li><b>Convention</b> — Gitmoji, Conventional Commits, or Free-form</li>
            <li><b>Commit Style</b> — One-line or Detailed</li>
            <li><b>Language</b> — English, Chinese, Japanese, Korean, Spanish, French, German, and more</li>
            <li><b>Custom Prompt</b> — Add extra AI instructions for your team's commit style</li>
            <li><b>Custom Templates</b> — Override the title/body templates for Template mode</li>
        </ul>

        <h3>Keyboard Shortcuts</h3>
        <table>
            <tr><td><code>Alt+G</code></td><td>Generate commit message</td></tr>
            <tr><td><code>Alt+H</code></td><td>Browse Smart Commit history</td></tr>
        </table>
    ]]></description>

    <depends>com.intellij.modules.platform</depends>
    <depends>Git4Idea</depends>

    <extensions defaultExtensionNs="com.intellij">
        <checkinHandlerFactory
                implementation="com.smartcommit.checkin.SmartCommitHandlerFactory"/>

        <applicationConfigurable
                parentId="tools"
                instance="com.smartcommit.settings.SmartCommitConfigurable"
                id="com.smartcommit"
                displayName="Smart Commit"/>

        <applicationService
                serviceImplementation="com.smartcommit.settings.SmartCommitSettings"/>

        <applicationService
                serviceImplementation="com.smartcommit.history.CommitMessageHistory"/>

        <notificationGroup
                id="Smart Commit"
                displayType="BALLOON"/>
    </extensions>

    <actions>
        <action id="SmartCommit.Generate"
                class="com.smartcommit.actions.GenerateCommitMessageAction"
                text="Generate Commit Message"
                description="Analyze staged changes and generate a commit message"
                icon="AllIcons.Actions.Lightning">
            <add-to-group group-id="Vcs.MessageActionGroup" anchor="first"/>
            <keyboard-shortcut keymap="$default" first-keystroke="alt G"/>
        </action>

        <action id="SmartCommit.History"
                class="com.smartcommit.actions.ShowCommitHistoryAction"
                text="Smart Commit History"
                description="Show previously generated commit messages">
            <add-to-group group-id="Vcs.MessageActionGroup" anchor="after" relative-to-action="SmartCommit.Generate"/>
            <keyboard-shortcut keymap="$default" first-keystroke="alt H"/>
        </action>

        <action id="SmartCommit.Settings"
                class="com.smartcommit.actions.OpenSmartCommitSettingsAction"
                text="Smart Commit Settings..."
                description="Open Smart Commit plugin settings"
                icon="AllIcons.General.Settings">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>
    </actions>
</idea-plugin>
